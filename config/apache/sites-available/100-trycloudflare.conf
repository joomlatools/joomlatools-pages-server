# .trycloudflare.com vhost proxied by CloudFlared
#------------------------------------------------

# https://*.trycloudflare.com
<VirtualHost *:80>

    ServerName trycloudflare.com
    ServerAlias *.trycloudflare.com

    use vhost
    use site

    <DirectoryMatch "^${APP_ROOT}/sites/(?<sitename>[^/]+)">
        RequestHeader set  X-Site-Name "expr=%{env:MATCH_SITENAME}"
        RequestHeader set  X-Site-Base "expr=\/%{env:MATCH_SITENAME}"
    </DirectoryMatch>

</VirtualHost>

# https://*.trycloudflare.com
<VirtualHost *:443>

    ServerName trycloudflare.com
    ServerAlias *.trycloudflare.com

    use ssl default

    use vhost
    use site

    <DirectoryMatch "^${APP_ROOT}/sites/(?<sitename>[^/]+)">
       RequestHeader set  X-Site-Name "expr=%{env:MATCH_SITENAME}"
       RequestHeader set  X-Site-Base "expr=\/%{env:MATCH_SITENAME}"
    </DirectoryMatch>

</VirtualHost>